import { getContainingTrack, getContainingView, getSession, } from '@jbrowse/core/util';
import { getSnapshot } from 'mobx-state-tree';
export async function fetchChains(self) {
    // @ts-expect-error
    const { rpcSessionId: sessionId } = getContainingTrack(self);
    const { rpcManager } = getSession(self);
    const view = getContainingView(self);
    if (!view.initialized || self.error || self.regionTooLarge) {
        return;
    }
    self.setLoading(true);
    const ret = (await rpcManager.call(sessionId, 'PileupGetReducedFeatures', {
        sessionId,
        regions: view.staticBlocks.contentBlocks,
        filterBy: getSnapshot(self.filterBy),
        adapterConfig: self.adapterConfig,
    }));
    self.setChainData(ret);
    self.setLoading(false);
}
